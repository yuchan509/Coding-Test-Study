{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "1a1c97f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "import konlpy, re, tqdm, os\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "from konlpy.tag import Okt\n",
    "\n",
    "import tensorflow as tf\n",
    "from keras.models import Sequential, load_model\n",
    "from keras.layers import Embedding, GlobalAveragePooling1D, Dense\n",
    "from tensorflow.keras.utils import to_categorical\n",
    "from keras.preprocessing.text import Tokenizer\n",
    "from keras.preprocessing.sequence import pad_sequences\n",
    "from keras.callbacks import EarlyStopping, ModelCheckpoint"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b84317ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Load train & test dataset.\n",
    "train = pd.read_csv('open/open/train.csv')\n",
    "test  = pd.read_csv('open/open/test.csv')\n",
    "# display(train)\n",
    "# display(test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "f396cddc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "index           0\n",
       "제출년도            0\n",
       "사업명             0\n",
       "사업_부처명          0\n",
       "계속과제여부          0\n",
       "내역사업명           0\n",
       "과제명             0\n",
       "요약문_연구목표     3002\n",
       "요약문_연구내용     3001\n",
       "요약문_기대효과     3051\n",
       "요약문_한글키워드    3028\n",
       "요약문_영문키워드    3087\n",
       "label           0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 결측치 확인.\n",
    "# baseline ==> 과정명 변수만을 이용하여 학습하므로, 다른 변수의 결측은 제거나 대치하지 않고 진행.\n",
    "train.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "c3a2246d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "x_train shape: (174304,)\n",
      "y_train shape: (174304,)\n",
      "x_test shape:  (43576,)\n"
     ]
    }
   ],
   "source": [
    "# baseline ==> Feature : 과제명 하나만을 이용토록 한다.\n",
    "x_train = train['과제명']\n",
    "y_train = train['label']\n",
    "x_test  = test['과제명']\n",
    "\n",
    "# Shape of dataset.\n",
    "print(f'x_train shape: { x_train.shape }')\n",
    "print(f'y_train shape: { y_train.shape }')\n",
    "print(f'x_test shape:  { x_test.shape }' )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "8da87332",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "100%|█████████████████████████████████████████████████████████████████████████| 174304/174304 [03:12<00:00, 903.23it/s]\n",
      "100%|███████████████████████████████████████████████████████████████████████████| 43576/43576 [00:52<00:00, 827.85it/s]"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Train data : 174304\n",
      "Test data  : 43576\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "\n"
     ]
    }
   ],
   "source": [
    "# text 정제 함수 생성 : 한글 이외의 문자는 전부 제거함.\n",
    "def Preprocessing(text, tagger, remove_stopwords=False, stop_words=[]) :\n",
    "    # 한글 정규식 정의(띄어쓰기, ㄱ ~ ㅣ, 가 ~ 힣)\n",
    "    text = re.sub('[^ ㄱ-ㅣ가-힣]+','',text)\n",
    "    \n",
    "    # 텍스트를 형태소로 분리후 각 단어로부터 어간을 추출.(stem=True)\n",
    "    word_text = tagger.morphs(text, stem=True)\n",
    "    \n",
    "    # 불용어 처리.\n",
    "    if remove_stopwords :\n",
    "        word_text = [ t for t in word_text if not t in stop_words ]\n",
    "        \n",
    "    return word_text\n",
    "\n",
    "# 한글 불용어 사전 파일 이용.\n",
    "with open('korean_stopwords.txt', encoding='utf-8') as fp :\n",
    "    stop_words = fp.readlines()\n",
    "    \n",
    "# \\n 제거.\n",
    "stop_words = [ x.strip() for x in stop_words ]\n",
    "# print(stop_words)\n",
    "# print('-'*135)\n",
    "# print()\n",
    "\n",
    "# Okt 이용.\n",
    "tagger = Okt()\n",
    "\n",
    "# train, test 데이터를 정제한 텍스트를 담을 리스트 생성.\n",
    "Clean_train_data = []\n",
    "Clean_test_data  = []\n",
    "\n",
    "# Train dataset 정제 작업 시작.\n",
    "for text in tqdm.tqdm(x_train) :\n",
    "    try :\n",
    "        Clean_train_data.append(Preprocessing(text, tagger, remove_stopwords=True, stop_words=stop_words))\n",
    "    except :\n",
    "        Clean_train_data.append([])\n",
    "\n",
    "# est dataset 정제 작업 시작.\n",
    "for text in tqdm.tqdm(x_test) :\n",
    "    if type(text) == str :\n",
    "        Clean_test_data.append(Preprocessing(text, tagger, remove_stopwords=True, stop_words=stop_words))\n",
    "    else :\n",
    "        Clean_test_data.append([])   \n",
    "        \n",
    "# 정제된 데이터의 수.\n",
    "print(f'Train data : {len(Clean_train_data)}')\n",
    "print(f'Test data  : {len(Clean_test_data)}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "ee8ec047",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "최대 단어의 개수 : 46\n"
     ]
    }
   ],
   "source": [
    "# 우선 특별한 옵션을 지정하지 않고 진행.\n",
    "token = Tokenizer()\n",
    "\n",
    "# fit_on_texts() : 입력으로 들어온 텍스트에서 단어의 빈도수가 높은 순으로 낮은 숫자부터 인덱스 부여, 단어 집합 생성.\n",
    "token.fit_on_texts(Clean_train_data)\n",
    "\n",
    "# 단어 사전을 통해 문장의 각 단어를 숫자(시퀀스 형태)로 변환. : 인덱스로만 채워진 새로운 배열을 생성한다는 의미.\n",
    "Train_squences = token.texts_to_sequences(Clean_train_data)\n",
    "Test_squences  = token.texts_to_sequences(Clean_test_data)\n",
    "\n",
    "# 한 문장의 최대 단어 수를 가져옴.\n",
    "max_cnt = 0\n",
    "for c in Train_squences :\n",
    "    # 현재 문장의 글자수.\n",
    "    cnt = len(c)\n",
    "    # 현재 문장의 글자수가 이전 최대 수치보다 많으면 덮어쓰기.\n",
    "    if max_cnt < cnt :\n",
    "        max_cnt = cnt\n",
    "print(f'최대 단어의 개수 : {max_cnt}')\n",
    "\n",
    "# Padding 처리 : 서로 길이가 다른 리스트의 개수를 max_cnt로 맞춰줌.\n",
    "# 끝 부분으로 적용. ==> 즉 max_cnt 길이의 리스트로 동일하게 맞춰주기 위해 부족한 부분으로 뒤에서 부터 0으로 채우는 작업을 의미.\n",
    "padded_train = pad_sequences(Train_squences, max_cnt, padding='post')\n",
    "padded_test  = pad_sequences(Test_squences, max_cnt, padding='post')\n",
    "\n",
    "# One-hot-encoding.\n",
    "# 주의 : 맨 앞에 0이 추가됨.\n",
    "voca_size = len(token.word_index) + 1\n",
    "# train_x = to_categorical(Train_squences, num_classes = voca_size)\n",
    "# test_x  = to_categorical(Test_squences, num_classes = voca_size)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "9a2d1c7f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Epoch 00001: val_loss improved from inf to 0.82633, saving model to models\\1-0.8263311982154846.hdf5\n",
      "\n",
      "Epoch 00002: val_loss improved from 0.82633 to 0.65824, saving model to models\\2-0.658235490322113.hdf5\n",
      "\n",
      "Epoch 00003: val_loss improved from 0.65824 to 0.58195, saving model to models\\3-0.5819496512413025.hdf5\n",
      "\n",
      "Epoch 00004: val_loss improved from 0.58195 to 0.52111, saving model to models\\4-0.5211097002029419.hdf5\n",
      "\n",
      "Epoch 00005: val_loss improved from 0.52111 to 0.49372, saving model to models\\5-0.4937210977077484.hdf5\n",
      "\n",
      "Epoch 00006: val_loss improved from 0.49372 to 0.47540, saving model to models\\6-0.4754039943218231.hdf5\n",
      "\n",
      "Epoch 00007: val_loss improved from 0.47540 to 0.46287, saving model to models\\7-0.4628666043281555.hdf5\n",
      "\n",
      "Epoch 00008: val_loss did not improve from 0.46287\n",
      "\n",
      "Epoch 00009: val_loss improved from 0.46287 to 0.46113, saving model to models\\9-0.4611284136772156.hdf5\n",
      "\n",
      "Epoch 00010: val_loss did not improve from 0.46113\n",
      "\n",
      "Epoch 00011: val_loss did not improve from 0.46113\n",
      "\n",
      "Epoch 00012: val_loss did not improve from 0.46113\n",
      "\n",
      "Epoch 00013: val_loss did not improve from 0.46113\n",
      "\n",
      "Epoch 00014: val_loss did not improve from 0.46113\n",
      "\n",
      "Epoch 00015: val_loss did not improve from 0.46113\n",
      "\n",
      "Epoch 00016: val_loss did not improve from 0.46113\n",
      "\n",
      "Epoch 00017: val_loss did not improve from 0.46113\n",
      "\n",
      "Epoch 00018: val_loss did not improve from 0.46113\n",
      "\n",
      "Epoch 00019: val_loss did not improve from 0.46113\n"
     ]
    }
   ],
   "source": [
    "# Modeling.\n",
    "\n",
    "# 학습 모델을 구성.\n",
    "model = Sequential()\n",
    "\n",
    "# word embedding : 데이터 공간의 효율성을 위해 주어진 배열을 정해진 길이로 압축하는 작업.\n",
    "# keras의 Embedding 함수는 오차역전파 방식으로 각 단어 간의 최적의 유사도를 계산.\n",
    "model.add(Embedding(voca_size, 32, input_length = max_cnt))\n",
    "\n",
    "# 임시 데이터에 대한 글로벌 평균 풀링 작업.?\n",
    "model.add(GlobalAveragePooling1D())\n",
    "model.add(Dense(128, activation = 'relu'))\n",
    "model.add(Dense(46, activation = 'softmax'))\n",
    "# model.summary()\n",
    "\n",
    "# 컴파일.\n",
    "model.compile(loss = 'sparse_categorical_crossentropy', optimizer = 'adam', metrics = ['accuracy'])\n",
    "\n",
    "# 모델 저장 폴더 설정.\n",
    "model_dir = './models/'\n",
    "if not os.path.isdir(model_dir) :                                                           \n",
    "    os.mkdir(model_dir)\n",
    "    \n",
    "# Callback 조건 설정.\n",
    "model_path = 'models/{epoch}-{val_loss}.hdf5'\n",
    "callback1 = ModelCheckpoint(filepath = model_path, monitor = 'val_loss', verbose = 1, save_best_only = True)\n",
    "callback2 = EarlyStopping(monitor = 'val_loss', patience=10)\n",
    "\n",
    "# 모델 학습.\n",
    "history = model.fit(padded_train, y_train, validation_split = 0.2, epochs = 30, verbose = 0, callbacks = [callback1, callback2])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "71726edc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5447/5447 [==============================] - 2s 422us/step - loss: 0.2790 - accuracy: 0.9223\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "0.9222851991653442"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 성능 최적의 모델 로딩.\n",
    "best_model = load_model('models/9-0.4611284136772156.hdf5')\n",
    "best_model.evaluate(padded_train, y_train)[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "cd96ac58",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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V7/6VebOncuWLVtYtGgRTz/9NACvvvoq559/PrNmzeJzn/vcifrGjRvHP/3TPzFv3jxmzZrF+vXre/1Zf/azn52Y0euhhx4CIJFIsGjRImbOnMmsWbP4X//rfwHw8MMPM336dGbPns2dd955hv9VT9WbhSIqgF0dHtcACzodsxK4DfiDmc0HxgKVQN05V3imSsohluunxpw0d8DfXkSkv/x2RSN7DyX79DVHFYa4dm73sxYWFxczf/58XnrpJW6++WaeeOIJPvWpT2FmfOtb32LEiBEkEgmuvvpqVq1axezZs7t8nffee48nnniC999/n3g8zrx587jgggsAuO222/j85z8PwN///d/zn//5n3zxi1/kpptu4sYbb+T2228/6bWamppYtGgRr776KlOmTOHee+/l3//93/nLv/xLAEpKSli+fDk/+MEP+O53v8ujjz562v8OtbW1PPTQQ7z33nsUFRVx7bXX8txzzzFmzBh2797NmjVrAE50uf/zP/8z27ZtIycnp8tu+DPVm5axdbGt8xya/wwUmdkK4IvA+8Apy3GY2f1mtszMlu3fv/9Ma+2dUBhGT9AgLhGRPtKxq7pjF/WTTz7JvHnzOP/881m7du1JXcqdvfnmm9x6663k5eVRUFDATTfddGLfmjVruPzyy5k1axaPP/44a9eu7bGeDRs2MH78eKZMmQLAfffdx+LFi0/sb1tO8YILLmD79u29+oxLly5l4cKFlJaWEolEuOeee1i8eDETJkxg69atfPGLX+Sll16ioKAA8PNn33PPPfz0pz8lEjn3BRB78wo1wJgOjyuB2o4HOOeOAJ8FML+21bbUjU7H/RD4Ifi5qc+u5F4onwQ7PoBjh2BoYb+9jYjIQOqpBdufbrnlFr7yla+wfPlyGhsbmTdvHtu2beO73/0uS5cupaioiEWLFtHU1NTj67QtfdjZokWLeO6555gzZw4//vGPef3113t8ndOtqdC2VOOZLNPY3WsWFRWxcuVKXn75Zb7//e/z5JNP8thjj/HCCy+wePFinn/+eb75zW+ydu3acwrl3rSMlwKTzWy8mcWAO4HnOx5gZoWpfQB/BixOBXQwyif6e42qFhE5Z0OHDmXhwoV87nOfO9EqPnLkCPn5+QwfPpy6ujp+85vf9PgaV1xxBc8++yyNjY0cPXqUX/3qVyf2HT16lNGjR9Pa2srjjz9+YvuwYcM4evToKa81bdo0tm/fzubN/t/4n/zkJ1x55ZXn9BkXLFjAG2+8QX19PYlEgp/97GdceeWV1NfXk0wm+cQnPsE3v/lNli9fTjKZZNeuXVx11VX8y7/8C4cOHeLYsWPn9P6njXHnXNzMHgReBsLAY865tWb2QGr/I8B5wH+ZWQL4APjTc6rqXI0YDbl5fmrMKacsjiEiImforrvu4rbbbjvRXT1nzhzOP/98ZsyYwYQJE7j00kt7fP68efP41Kc+xdy5cxk7diyXX375iX3f/OY3WbBgAWPHjmXWrFknAvjOO+/k85//PA8//PCJgVsAubm5/OhHP+KOO+4gHo9z4YUX8sADD5zR53n11VeprKw88fipp57i29/+NldddRXOOW644QZuvvlmVq5cyWc/+1mSSX+u/tvf/jaJRIJPf/rTHD58GOccf/VXf3XWI8bbZM8Sip397r9g3064+79BN10jIiLpTksoZq7BuYRiZ+UT/TnjIweCrkRERKRHWRzGk/29zhuLiEiay94wLiyFvGEKYxERSXvZG8Zm/hKn3Zv9Sk4iIhkqqLE9cvbO9DvL3jAGH8aNx+DQvqArERE5K7m5uRw4cECBnEGccxw4cIDc3NxeP+fcpw1JZxWpeap3b4aiYKbKFhE5F5WVldTU1NBvsxZKv8jNzT3p0qnTye4wHjbCz8BVuxlm9nwNnIhIOopGo4wfPz7oMqSfZXc3tRlUTPZhnOzbydVFRET6SnaHMfjrjZsb4eCeoCsRERHp0iAI47b1jbWKk4iIpKfsD+OhhTC8RNcbi4hI2sr+MAbfOt6zBZKJoCsRERE5xeAJ45ZmqK89/bEiIiIDbJCEcdv6xpuCrUNERKQLgyOM84b5ST9267yxiIikn8ERxuC7qvdug0Q86EpEREROMnjCuGISxFth366gKxERETnJ4Anj0RP9jFy6xElERNLM4Anj3DwoLlcYi4hI2hk8YQx+VHXdDt9dLSIikiYGWRhP8gO46rYHXYmIiMgJWRHGiaRj855WksnTLL49ekLqvLHmqRYRkfSRFWG8eU+cJ/5wnK11p7lsKZYLpWNgtyb/EBGR9JEVYTxxVITcqLF2Vy/OBZdPgv27/PSYIiIiaSArwjgSNqZVRlm/O05L/DRd1RWTIJn0E4CIiIikgawIY4BZVVFa446NtadpHZeNg1BYlziJiEjayJowHlMaZtiQEGt2niaMozEoq9IgLhERSRtZE8YhM2ZWRdm6N87x5mTPB5dPgvoaaG4cmOJERER6kDVhDDCjKkrSwbqa04yqLp8EzsGerQNTmIiISA96FcZmdp2ZbTCzzWb2tS72DzezX5nZSjNba2af7ftST69seIiSgjCrd7T0fODIKghHdN5YRETSwmnD2MzCwPeB64HpwF1mNr3TYX8BfOCcmwMsBP6HmcX6uNbTMjNmVUWpOZDgUEMPXdWRKIwarzAWEZG00JuW8Xxgs3Nuq3OuBXgCuLnTMQ4YZmYGDAUOAoEsHDyjKgpw+oFc5RPhwB5oPDYAVYmIiHSvN2FcAXRcBLgmta2jfwPOA2qB1cCXnXOnNE3N7H4zW2Zmy/bv33+WJfesMD9EZXGYNTtbca6Ha47LJ/l7nTcWEZGA9SaMrYttnVPuY8AKoByYC/ybmRWc8iTnfuicq3bOVZeWlp5hqb03a2yM+iMJ6g730FVdOgaiOZoaU0REAtebMK4BxnR4XIlvAXf0WeAZ520GtgHT+qbEM3deZYSQwZodPXRVh8Op88a63lhERILVmzBeCkw2s/GpQVl3As93OmYncDWAmZUBU4HA+n/zckJMHBVh7a5Wkj11VVdMgkP7oOHwwBUnIiLSyWnD2DkXBx4EXgbWAU8659aa2QNm9kDqsG8Cl5jZauBV4CHnXH1/Fd0bM6tiHG1MsnN/ovuDyif6e7WORUQkQJHeHOScexF4sdO2Rzr8XAtc27elnZsp5RFiEWPNzlbGjezmYxZXQM4Qf4nT5HkDW6CIiEhKVs3A1VE0YkytiLCuppV4opuu6lAIRk+A3breWEREgpO1YQwwsypKc6tj054eLnkunwRHD8KRgwNXmIiISAdZHcbjR0bIzzHW9jQBSNv1xpqNS0REApLVYRwKGdPHRNm0p5Wmlm66qovKYMhQhbGIiAQmq8MYYObYKIkkrN/dTes4FPKjqmu3+JWcREREBljWh3F5UZiioSFW9zQBSPkkf63x4UCvxhIRkUEq68O4bSWnHfvjHDnezfSYOm8sIiIByvowhvaVnNbu6qZ1PLwE8gs0+YeIiARiUIRx8bAwo4vC3S+raOZbx7Wbdd5YREQG3KAIY/ADueoOJdh/uJvpMcsn+bWNP6wb2MJERGTQGzRhPGNMFDNY011Xtc4bi4hIQAZNGA/NDTF+ZIS1O1txXXVFF4yAYSMUxiIiMuAGTRiDnx7zUEOSmgPddVWnrjdOdjPqWkREpB8MqjCeWhElErbuB3KVT4LmRjhQO7CFiYjIoDaowjgnakwpj/DBrlYSyS66qk+sb6yuahERGTiDKozBd1U3tji27O1iJaehhf6aY4WxiIgMoEEXxhPKIuTGeuiqrpgMe7ZBopvzyiIiIn1s0IVxJGxMr4yysTZOc2s3XdWtzVBfM/DFiYjIoDTowhj8BCDxhGNjbRet49E6bywiIgNrUIZxZXGY4XkhVnfVVZ03DEaMht0KYxERGRiDMoxDZsysirKtLk5DUxfXFJdPhLrtEO9h2UUREZE+MijDGPyoaue6WcmpYpIP4n07B74wEREZdAZtGJcOD1NW2M1KTqMm+JWctKSiiIgMgEEbxuAXj6g9mODg0U6XMeXmQUmFBnGJiMiAGNRhPLMqCnSzklP5RKjbAa0tA1yViIgMNoM6jAvyQlSVRlizo4uVnMonQzLhB3KJiIj0o0EdxuBbxwePJdnzYadR1aPGp84bq6taRET616AP4/Mqo4RDsGZnp+7oWA6MrNIgLhER6XeDPoyHxIxJo6Ks3dVK8pSu6kn+8qaW5mCKExGRQaFXYWxm15nZBjPbbGZf62L/V81sReq2xswSZjai78vtHzPHRmlocmzf12lUdflEcA72bg2mMBERGRROG8ZmFga+D1wPTAfuMrPpHY9xzn3HOTfXOTcX+FvgDefcwX6ot19MHh0hJ2qs2dGpq3rUeAiHNTWmiIj0q960jOcDm51zW51zLcATwM09HH8X8LO+KG6gRMLGtIoo63fHaU106KqORKFsHOz8wLeQRURE+kFvwrgC2NXhcU1q2ynMLA+4DvhFN/vvN7NlZrZs//79Z1prv5pZFaUl7thUGz95x9QL4dB+2L0pmMJERCTr9SaMrYtt3TUT/wT4Y3dd1M65Hzrnqp1z1aWlpb2tcUCMHRlmaG6I1Z1HVU+YA7n5sPaPwRQmIiJZrzdhXAOM6fC4Eqjt5tg7ybAu6jYhM2ZURdmyN05jS6eu6vMugh0fwJGMOQ0uIiIZpDdhvBSYbGbjzSyGD9znOx9kZsOBK4Ff9m2JA2dmVZRkEtZ1nh5z+sX+/oO3Br4oERHJeqcNY+dcHHgQeBlYBzzpnFtrZg+Y2QMdDr0V+K1zrqF/Su1/owpDFA8LnbqS09BCGDcT1r+jNY5FRKTP9eo6Y+fci865Kc65ic65b6W2PeKce6TDMT92zt3ZX4UOBDNjZlWMnfVxDjV0mh5z5mXQ3AiblwdTnIiIZK1BPwNXZ20rOa3t3FU9egKMGA1r/qjLnEREpE8pjDspGhqisjjMmh2dwtgMZl4KB2ph7/ZAahMRkeykMO7CjKoo+48kqDvUaXrMSedDzhBY+4dgChMRkaykMO7C9MooZpw6kCuaA1Pnw9ZVcOxQILWJiEj2URh3IT83xMSyCGt3drGS04xL/P26JQNfmIiIZCWFcTdmjo1ypDHJrvpOXdUFxVB1ng9jXeYkIiJ9QGHcjSnlUaIRO3UgF8CMS6HxmO+uFhEROUcK427EIsbU8gjralqJJzp1VVdMhsJSDeQSEZE+oTDuwcyqKE2tji17O63kFArBjMtg3y7YtzOY4kREJGsojHswoSxCXo7x/rYWXOeBXFMu8KOr16h1LCIi50Zh3INQyJg/OYfNe+Is39rp3HEsF6ZUw9aVcPxoMAWKiEhWUBifxiXTYkwcFeHlFY3sPtCpu3rGpZBI+AUkREREzpLC+DRCZtyyII+CISGefruRhqYOC0gUjYTKyfDB2z6URUREzoLCuBeGxIzbL86jsdnxzJJGkskO549nXAYNh2H7muAKFBGRjKYw7qVRRWGuvyCXHfvjvLamuX1H1XkwbIQucxIRkbOmMD4Dc8bFuGBijLc3NLOuJjWgKxTyU2Tu2Qb1u4MtUEREMpLC+Ax9dE4u5SPC/GppI/VHUueJp86HSBTWvhVscSIikpEUxmcoEvbnjyNheOqt4zS3OsjNg8nzYPNyaDoedIkiIpJhFMZnoSAvxG0X5XHwWJJfLWv0E4LMuNQvHLHh3aDLExGRDKMwPkvjRkb4yKxc1te0smRjCxSXw+gJvqs6mTz9C4iIiKQojM/BRVNiTKuI8vvVTWzfF4eZl8HRg7BzXdCliYhIBlEYnwMz408uHMKIoSGeWXKcI2XnQf5wzVctIiJnRGF8jnKixu2X5BFPwC/eaSY+7RLYvQk+rAu6NBERyRAK4z5QWhDmTy4cwu4DCX6XuADCYV3mJCIivaYw7iPnVUa5eGoO7+00Vo28BjYug5amoMsSEZEMoDDuQ1fNzGFsaYQXj89lb0s+bFgadEkiIpIBFMZ9KBQybrtoCEOG5vJ09EYa17yry5xEROS0FMZ9LD83xCcuHsKR3BKeOzSTZM3GoEsSEZE0pzDuB5XFET42v4gtVsUf3tbiESIi0rNehbGZXWdmG8xss5l9rZtjFprZCjNba2Zv9G2ZmWfepFxmj4qz+MAoNm+qD7ocERFJY6cNYzMLA98HrgemA3eZ2fROxxQCPwBucs7NAO7o+1Izi5lx/UfGUGYHee7tI3x4TOeORUSka71pGc8HNjvntjrnWoAngJs7HXM38IxzbieAc25f35aZmaIFhdwxfi8cP8LTfzxKa9wFXZKIiKSh3oRxBbCrw+Oa1LaOpgBFZva6mb1nZvd29UJmdr+ZLTOzZfv37z+7ijNM4dxqbuE16vYd48XlqRWeREREOuhNGFsX2zonSgS4APg48DHgH8xsyilPcu6Hzrlq51x1aWnpGRebkcrGManEcYV7j9U7WnlvS2vQFYmISJrpTRjXAGM6PK4Ears45iXnXINzrh5YDMzpmxIznBnMvIzLji9m0rAGfruykZr6eNBViYhIGulNGC8FJpvZeDOLAXcCz3c65pfA5WYWMbM8YAGgdQTbTDqfUO4QbuY1CoaE+MWSRhqaNKBLRES804axcy4OPAi8jA/YJ51za83sATN7IHXMOuAlYBXwLvCoc25N/5WdYSJRmLaAITtXcPucVhpbHM8saSSZ1PljEREBC2pAUXV1tVu2bFkg7x2IowfhZ9+GuVexuuwafvluIxdNyeGaOblBVyYiIgPEzN5zzlV33q4ZuAbKsBEwdgase4dZFUb1pBhLNjazYltL0JWJiEjAFMYDaeal0NQAW1ZwzexcJoyK8OtljazarkAWERnMFMYDqXwSFJXBmj8QCcEdl+QxfmSEXy1rZM1OBbKIyGClMB5IZjDjUqjfDXU7iIaNT16aR1VJhF++28gHu3QNsojIYKQwHmiTL4BYDqz9AwDRiPGpy/IYUxzh2XeOs65GgSwiMtgojAdaLAemzoetq6DhiN+UCuSKEWGeXXKcDbsVyCIig4nCOAjTL4FkEtYtObEpJ2rcdXk+o4rC/GLJcTbtUSCLiAwWCuMgFJbCmGmw7m1ItE+NmRM17r48n7LhYZ5+6zhb9iqQRUQGA4VxUGZeBsePwvp3T9qcGzPuviKfkoIwT/2xkW11msdaRCTbKYyDMmYqVEyCd1+AY4dO2jUkZtxzRR4jhoX4+R+Ps2OfAllEJJspjINiBpff7s8d/+EZ6DQtaV5OiHuuyKMwP8QTfzjOzv0KZBGRbKUwDtLwEqj+GOz4ALasPGV3fm6Iz1yZR0Ge8bM/HNfSiyIiWUphHLRZl0PpGHjrOT9VZif5uSE+fWU+w3KN//vmcXYfUCCLiGQbhXHQQmG48g5oPg5v/bLLQ4YN8YGcnwrk2oOJAS5SRET6k8I4HRSXw9yPwKblsHN9l4cU5IX4zJX5DIkZ/3dxA3s/VCCLiGQLhXG6OP9qKBoJbz4NLc1dHlKQ51vIsajx08UN1B1SIIuIZAOFcbqIROGKT0LDYXj3xW4PK8z3LeRo2Hh8cQP7DiuQRUQyncI4nYwa51d1+uAt2Lut28OKhob49JV5hEPG4280sP+IAllEpK8ca0qycnsLL7zXiOt02Wl/URinmwuvh6GF8MZTEO9+OsziYWE+fWUeGPz0jQYOHFUgi4icjUTSsWN/nNdWN/EfvzvGv/7qKL9a2sjG3a0cbRyYMLaBSv3Oqqur3bJlywJ577S3az28+CjMuwYuvK7HQ/cfTvCTNxoIh4zPXJnHiGHhASpSRCRzHT6eZMueOFvq4myri9MSd5jBmJIIE8siTBwVYWRhiJBZn76vmb3nnKvuvD3Sp+8ifWPMNJhyAaz4PYyfBSUV3R5aOjzMp6/M56dvNPDTN45z71X5FOarw0NEpKN4wrGzPsGWvXG27I1Tnzq9VzAkxIwxUSaOjjBuZITcaN+Gb2+pZZyumhrgye/4LutbvuivR+7B3kMJfvpGAzkR4zMLFcgiIgePtofv9v0J4glHOARVpb7lO7EsQklBCOvj1m9P1DLONLn5cOkt8MpPYfWbMGdhj4ePKgxzzxX5PP5GAz99o4F7F+ZTkKdAFpHBoyXu2L4vztY6H8AfHksCftDr3PFRJo2KUFUaIRYJpvXbE4VxOpswB8a9D0tfgnEz/VzWPRhdFObuK/J5fHED//nKMeZPzmHexBhDYun3iycig0dr3HGowQdjx77Yto7ZU/pnO2/v4jiXepRMwu4DvgW8sz5OIgnRsDFuZJj5k2NMLItkxFgadVOnu2OH4KnvQEkl3PiAX+3pNPYeSvD71U1s3RsnFjHmjo+yYEoOw9VSFpEB0NzqqDkQZ2d9gh374tR+mCCZ7N/3LCkIM2mU734eUxImEk7PRoi6qTPV0EK46E9g8dOw/h0476LTPmVUYZi7L89n76EE72xsZunmFpZtbmFGVZSLpuRQVpj+/5coIpmjqdWxqz7Ozv0JduyPs+fDBM75tsPoojALJudQ1mFkcldtirZtnXd11/4waz925PBwxp+WUxhngmkLYPP7sORXfqT10MJePW1UYZib5+excGaSdzY2s2JbK6t3tDKhLMLFU3MYNzI8oAMXRCQ7NLY4du6Ps2O/D+C6wz58QyGoGBHhkmk5jC2NUDEiTE5Ao5MzjbqpM8XhenjquzBmKly7qFfd1Z01tjiWb2nh3U3NNDQ7ygrDXDI1h/MqI4RC+oMRka41NCV9l3MqfNum4Y2EjIriMGNLw1SVRqgoDhNN0+7hdHFO3dRmdh3wPSAMPOqc++dO+xcCvwTa5nB8xjn3jXMpWDoZXuInAFnya9i6CibOOeOXGBIzLj0vhwVTYqze0cqSjc08+85xXlsTYv7kGHPHx9JylKGIDKyjjUl27I+zY3+CXfVx6o/4E77RsFFZEubKylzGloYpH5G+52YzzWnD2MzCwPeBjwI1wFIze94590GnQ990zt3YDzVKm1mXw5YV8MdnoWKSv/zpLETCxvkTYswZH2VTbZy3NzTz2xVNLP6gmeqJMS6cFCM/N7PPv4hI7zS1OOoOJ9h3KMHeQ0l21rdfEhSLGGNKwsweG6OqNMzoojBh9aL1i960jOcDm51zWwHM7AngZqBzGEt/C4Xhijvg2e/B28/DVXed28uZMbUiytSKKDX1cd7e0MIf1jWzZEMLs8ZFuWhKjOIMuCRARE4v6RyHjiWpO5yk7lAiFcBJDh9vH+Y8JOZbvhdMiFFVGmFUYUinsAZIb8K4AtjV4XENsKCL4y42s5VALfDXzrm1fVCfdFZSAXOugvdfhUnn+wFdfaCyJMIdJREOHE2wZGMLq7e38v7WFqZVRLloaozKYo31E8kUza2O/YcTJ4J33+EE+w4naYn7MUJmUDwsREVxmHkTY5QND1FWGGZormlQZ0B68y9sV99M51Ffy4GxzrljZnYD8Bww+ZQXMrsfuB+gqqrqzCqVdvOugW2r/eVOd3wVYjl99tLFw8J8/IIhLJyRw7ubW3hvcwvrd7dSVRLhoqkxJo2O9PnE6SJydpxzHD7u2Hc44Vu7h5LUHU6c6GYGyIkaZYVh5oyLUlYYZuTwMKXDQxpolWZOO5razC4Gvu6c+1jq8d8COOe+3cNztgPVzrn67o7RaOpztHcbPP8Dv/7xpbf029s0tzpWbG/hnY0tHDmepKQgxKyxMaaURygZNrBzuooMVvGE4/DxJB8eS3KowXHgqG/17juUoKm1/d/woqEhyoaHKSsMnQje4Xlq7aaTcxlNvRSYbGbjgd3AncDdnV58FFDnnHNmNh+/TvKBcy9bujVqPEy/BNb+ESbOhVHj+uVtcqLGgsk5VE+Msa6mlXc3tfDa6iZeW+3/8KeWR5lcHmFMcVjnlkTOUtI5Gpr8lJGHGpJ82JDkUCp4P2xIcrTx5OmrohGjbHiI6WN8a7dseIjS4bqmN5OdNoydc3EzexB4GX9p02POubVm9kBq/yPA7cAXzCwONAJ3uqAuYB5M5t8AO9bC4ifhtr+CSLTf3iocMmZWxZhZFePI8SSb9sTZWNvK0s3NLNnYzJCYMWl0hCnlUSaURfSPgkgnza2dwrYtcI8nOXTMEU+e/E/msCEhivJDjB8ZpnBolKL8EIWpW36u6XRRltGkH5lu53r4zaP+PPKF1w342ze3OrbW+WDetCdOU4sjEvKTtE9JtZqHDdFlUpJ9ks7REveXBjW1OBpbHE2tqfvU47au5cPHkxxvPvnf2pyoUZgfOilkC/ONoqEhhueFdP1ultLc1NmqahpMngcrfg8TZkNx+YC+fU7UOK8yynmVUZJJx676BBtqW9lYG2fz8kZY7uemnVoRZUp5hNIBXjtUpCfOOZp7CNS2n5tbHI2tnba1Onpqy4RCMDzPh+yoovaWbVF+iMKhIXKj6G9BTlDLOBs0NcCT34GhRXDLg/565IA556g/kmRDrW811x700+cV5oeYUh5h8ugoVaWaQEAGRjzhOHgsyYGjSeqPJDlwNMGBo/5x2+U+XQkZ5MaM3KiRGzOGxDrcp7blRtu3t/2cEzViEYWtnEot42yWmw+X3AKv/hRWvwlzFgZdEWZG6fAwpcPDXHZeDkcb288zL9/iB4LlRo2JoyNMLY8ycZTOM8u5cc5xvNn5wE0F7YEjCeqPJk+spdumIC9EybAQc8ZFGZ4XOiloFagSBIVxtpg4BzYvh2Uvw7iZfi7rNDJsSIh5E2LMmxCjJd52njnO5j2trN3ZSigEY4ojVBb7+W7LR4R1rlm6lEj6gVDtrVzf0q0/mqSppb2VGwkZxQUhykeEmT02SvGwMMXDQowYFtIc7JJ21E2dTY4dgqe+A6Vj4OP/z1mt7DTQks5RcyDBxt1xtu2Ls/9wgrZBpcOGhCgvag/n0SPC5Kr1nDWSSUdLAlpaHa0JR0srtCQcrXE/MKol3v5zU6vj4NEk9Uf9hBYdBx7n5xolqaAtLvAt3uJhYQryNOJY0o+6qQeDoYWw4EZ48xew4V2/DnKaC5lRVRKhqsT/KrYmHHUfJtj9YYI9BxPUHvQDwtoUDwudCOfyEWHKhmvVmIEUT/iBS01ttxbaH7c4WuIuFaI+TH24pn6OkwpXv63zpTw9CYVgxNAQJQVhplVEffCmQjc3pu9fMp/CONtMWwCb34c/PgdFo6BsbNAVnRG/RFuEypL2X83GFkftwQR7Pkyw+2CcrXvjrN7hAzoUgrLh7eFcXhSmuCDULy0i5xzxhA+WplYfLomkY0jMyM8JkZMBo2PjifYRw81t9610CNe2be6kkPXH9y5AYxFL3fzkFLGIPwdbMMRvi0WNaDj1c8RSx6R+DhuxKMTCJ28Ph9L/v63IuVA3dTY6fgR++W/Q0gQ3/QUUlQVdUZ9yznG00bE71XJuC+q2UbGxiDG6Q/d2+YgwkRA0p1poza2u/b4Vmk/aljom7mhJBVVzvP34013KkhcLkZdj5OcYQ1L3eTlGXk4odW8n9ufGzr4b1TlHa8L/j8rxZh+wjc2O4y1JGlOPT2zv8HNPI4fbPsOQqB+8lJsaxJQbbR85fOJxjJP25UQ14EmkN7rrplYYZ6vD9T6QwxG4+UHfhZ3Fks6Poq3tENB1hxMkk6d/bptYpD1QcqJGTsSIRY2cVGvuxLaIkRNtb7E1tjgamn3gHW92NDT7QGzb1tza9d+YmV+yrmNQ53cI8mQSjqdCtnO4NjafOmNTR7lR/xpDYkZerMPPOaETl+XkRNsv22kL34haoCL9SmE8GNXvhl/9APKH+xZybn7QFQ2oeMIvmr73wyRJ506ErQ9ZOgSrEY3Qb4N94olUULe0BXbypPBuv/ntHUcEtwX2iVuOnWh9+3DtvM//rHnCRdKTwniwqt0CL/6Hn5nrxv8Hon233KL0j2TSt35DId961YhgkezRXRjrQs5sVz4Rrv407N8Fv/svSMSDrkhOIxQy8nN9d7KCWGRwUBgPBuNnwhW3w64N8PrPOaMTqSIi0u90adNgMW0BNDbAuy+mps+8OSMmBRERGQwUxoPJ3Kug8aifv3rIUL/sooiIBE5hPJiYwUV/4ld5WvqSD+TzLgq6KhGRQU9hPNiEQnDlp6D5uJ82MyfPr4MsIiKB0QCuwSgchmvuhZFV8PvHYffmoCsSERnUFMaDVTQG1/0pFJTAyz+C/TVBVyQiMmgpjAez3Dy44fOQMwR+8ygc2h90RSIig5LCeLAbWggfvx+c8zN1NRwOuiIRkUFHYSxQOBKu/zM/yvrFR6G5MeiKREQGFYWxeCPHwLX3waF98NJjEG8NuiIRkUFDYSztKqfAR+6Cuu3wyk8gmQi6IhGRQUFhLCebOBcuvRV2fACLn/bnkkVEpF9p0g851YxLoOkYLPutn8f6ohuDrkhEJKspjKVr8z7qF5ZY+bqfNnPOwqArEhHJWgpj6ZqZX9mpqQGW/Nq3kKdeGHRVIiJZSWEs3QuF4Ko7obkB3njSB/LY6UFXJSKSdXo1gMvMrjOzDWa22cy+1sNxF5pZwsxu77sSJVDhCHx0EZRUwu/+C/ZsC7oiEZGsc9owNrMw8H3gemA6cJeZndI8Sh3334GX+7pICVgsB67/UxhWBC8/Bvt2BV2RiEhW6U3LeD6w2Tm31TnXAjwB3NzFcV8EfgHs68P6JF0MGQo33A+xIfD892H9u0FXJCKSNXoTxhVAx6ZQTWrbCWZWAdwKPNLTC5nZ/Wa2zMyW7d+vRQkyzrAiuPXLMGq8P4e8+GnN1CUi0gd6E8bWxbbOM0H8K/CQc67HKZuccz90zlU756pLS0t7WaKklSH5fqWnuR+BdUvg14/AsUNBVyUiktF6E8Y1wJgOjyuB2k7HVANPmNl24HbgB2Z2S18UKGkoFIIFN8BH74WDe+GZf4XaLUFXJSKSsXoTxkuByWY23sxiwJ3A8x0PcM6Nd86Nc86NA54G/tw591xfFytpZsJsuPVLfj3kXz8Cq9/U9JkiImfhtGHsnIsDD+JHSa8DnnTOrTWzB8zsgf4uUNJcUZk/jzx2Brz1S/j9/4XW5qCrEhHJKOYCaslUV1e7ZcuWBfLe0g+SSVj5Gix9CUaMgo/eB8NLgq5KRCStmNl7zrnqztu1apP0jVAIzr/aX4987BA8+z3YuS7oqkREMoLCWPrWmGlw21/B0CJ46TF473e+1SwiIt1SGEvfKxgBNz8Ik86HZS/Db38MzY1BVyUikrYUxtI/ojG46i649FbYtd53Wx/cE3RVIiJpSWEs/ccMZl4Kf/IFP8L6uf8NW1YEXZWISNpRGEv/GzXen0cuLodXfgpv/wqSPU7WJiIyqCiMZWDkF8CND8CMS2HVG/DCD+H40aCrEhFJCwpjGTjhCFx2Kyz8FNTt8NNo7tsZdFUiIoFTGMvAm3oh3PJFCIVTyzG+E3RFIiKBUhhLMEoq4LYvw+iJ8MZTWo5RRAY1hbEEJzcfrv8zOD+1HOMv/w327Tr980REsozCWIIVCsH8G+DaRdBw2F+P/PrPNbhLRAaVSNAFiAAwfiZUTILlr/ilGLetgguu9aOvw/o1FZHsppaxpI9YLlx0I9zx11A23l+P/PT/9DN4iYhkMYWxpJ/CUrjhz+C6z4FLwouP+kUnDtcHXZmISL9Q/5+kr7HToWIyrPmD775+6jsw60q/VGMsJ+jqRET6jMJY0lskCnOvgskXwLsvwIrfw6ZlsODjMGmen/9aRCTDqZtaMkN+gV8F6pYvQt5w+P3P/KVQ+3UplIhkPoWxZJaysT6Qr/wkHDkAzz4Mi5+CxmNBVyYictbUTS2ZJxSCafNh/CxY/jt/TnnLyg6XQoWDrlBE5IyoZSyZK2cIXHwT3P7/+hbz28/DL/4H1GwMujIRkTOiMJbMV1Tmp9X82GchEffLM778Y9+NLSKSAdRNLdnBDMbNgMopsHoxvP8qPPkdmH2ln/s6qkuhRCR9KYwlu0Si/jrkyRfAuy/6UN64zJ9PnjzP7xcRSTPqppbsNLQQPnI33PwXkFfgR1z/7Nuw4jVoaQq6OhGRk6hlLNlt1Hi49Uuwe5MP4nde8K3lGZfAzMshb1jQFYqIKIxlEDDz55Irp/j1kle+5oN51WKYeqE/rzy8JOgqRWQQUxjL4DJyDHz0Xji0H1a9DhvehXVLYMIcP+1mSUXQFYrIIKQwlsGpsBSuuMMP7Fr9JnzwNmxZ4VvPc6+C8kma91pEBkyvBnCZ2XVmtsHMNpvZ17rYf7OZrTKzFWa2zMwu6/tSRfpB/nC/hvI9fw/zb4ADtfDr/89Ps7l1FSSTQVcoIoOAOed6PsAsDGwEPgrUAEuBu5xzH3Q4ZijQ4JxzZjYbeNI5N62n162urnbLli071/pF+la81V8KtfJ1P2nI8BKYc5UuixKRPmFm7znnqjtv70039Xxgs3Nua+qFngBuBk6EsXOu4yz9+UDPCS+SriJRmH4xTFsA21b5gV6Ln4JlL8Osy/2+WG7QVYpIlulNGFcAHdepqwEWdD7IzG4Fvg2MBD7e1QuZ2f3A/QBVVVVnWqvIwAmFYOJcP7BLl0WJSD/rTRh3NYrllJavc+5Z4FkzuwL4JnBNF8f8EPgh+G7qMytVJAC6LEpEBkBvwrgGGNPhcSVQ293BzrnFZjbRzEqcc/XnWqBI2ujusqjKKb5be+x0COsCBRE5c735l2MpMNnMxgO7gTuBuzseYGaTgC2pAVzzgBigJXMkO3W8LGrdO7D+Hfjdf8GQoTCl2q+1XDgy6CpFJIOcNoydc3EzexB4GQgDjznn1prZA6n9jwCfAO41s1agEfiUO90wbZFMlz8cqq+FeddAzQYfyqve8COxR0/wreUJszUKW0RO67SXNvUXXdokWen4EdiwzAfzkQOQMwQmzYPzFkBxedDViUjAzuXSJhHprbwCv37ynIWwZyusX+Jva//ozzlPWwATz4eY1lcWkXYKY5H+EApBxSR/a2qATcv9YK/FT8Pbz/tAnjYfRlZp2k0RURiL9LvcfD9hyMzLoG6H78LevNzfjxjtu7AnzYPcvKArFZGA6JyxSBBammDz+z6Q99f4S6ImzPbd2KMnqLUskqV0zlgkncRy/dSa0y+G+t0+lDct97fhJT6UJ8/zI7ZFJOupZSySLlpb/HzY696Bvdv8trKxMH6WvxUUB1ufiJwztYxF0l005icNmVINh/b5JRy3rYYlv/a34vL2YC4qU1e2SBZRy1gk3R05CNtX+2Cu2wHO+a7s8bN9MJdWKphFMoRaxiKZqmCEX5Bi9pXQcAR2rPWt5pWvwYrfw9BCH8rjZsKo8f6yKhHJKApjkUySX9A+8KvpuA/mbavhg7dh9Zt+fuxxM3w4l0/SwhUiGUJ/qSKZKjfPL+M49UJoaYZd630wb17hB4HFcv1KUuNnQeVUf05aRNKSwlgkG8RyYOIcf4u3wu5NPpi3r/GXS0WiMGaaD+aq8/yc2SKSNhTGItkmEvUt4rHTIXm7nyN72xofzttWQygMo8b5cK6aBkWjNABMJGAaTS0yWCSTsG+nP8+8az0c2OO3Dy2EMVN9OFdM9t3bItIvNJpaZLALhXyLeNQ4WPBxOHYIdm3wwbxlhT/PHAr5EdlqNYsMKLWMRQQSCajb7oO5Y6s5f7gPZbWaRfqEWsYi0r1wGMon+ltbq7lmA+zsptU8ZhqMUKtZpK+oZSwiPeup1dzWna1Ws0ivqGUsImenp1bz1hV+xam2VnPFZH9c6RhNOCJyBvTXIiJnZmihX+Jx2oIOrebUQLClL/ljIlG/4tToCTB6Ioys8ttEpEsKYxE5eye1mm+AxgbYu9Vf21y7Bd77Hbjf+lbyyKpUOE+AsnGaEUykA4WxiPSdIfntyzyCnz977zYfznu2wvuvwvJX/MQjpZU+xEdPgLLxfhYxkUFKYSwi/Sc3zy9cMW6Gf9zSBHu3w54tPpxXvg7v/96Pyi6t9F3aoyf488+aslMGEYWxiAycWK4ffV01zT9uaYZ9O3yX9p6tfuWpla/7cC4u98FcPhFGTfDBLpKlFMYiEpxYDlRO8Tfwi1zU7Uidc97cvjQkQOFIPyhsZJW/jRjlu7tFsoDCWETSRyQKFZP8jWt9OO/f5cN5307YuQ42LG0/tnRMKqBTIZ1fEGj5ImdLYSwi6SsSbR+BDeAcHD3oW8/7dkDdTli1GJIJv39o4cnhXFKhS6okIyiMRSRzmEFBsb9Nnue3xVuhfrdvOe/b4e+3rPT7QmF/7rks1bU9cqx/rqbxlDTTqzA2s+uA7wFh4FHn3D932n8P8FDq4THgC865lX1ZqIhIlyLR9tWo2jQcaQ/nuh2w/l1Y80e/Lzf/5HPPpWM0clsCd9owNrMw8H3go0ANsNTMnnfOfdDhsG3Alc65D83seuCHwIL+KFhE5LTyC2D8TH8D3419cG8qoHf6gN7R4Z+wYSOgpByKK3xLuqTCz72tFrQMkN60jOcDm51zWwHM7AngZuDEb7Jz7q0Oxy8BKvuySBGRcxIK+4AtqYDpF/ttTcdh/07fxV2/Gw7UwrY17c/JzW8P5rb74aV+Hm6RPtabMK4AdnV4XEPPrd4/BX5zLkWJiPS73Lz25SDbtDTDwVqor4UDqZBe86afgxt8l/iI0SeH9IjRmtpTzllvwrirfpou1100s6vwYXxZN/vvB+4HqKqq6mWJIiIDJJbjZ/8aNb59WyIBh+p8y7mtBb11Jaxb4vebQWHpyV3cxRV+alCRXupNGNcAYzo8rgRqOx9kZrOBR4HrnXMHunoh59wP8eeTqa6uDmYhZRGRMxFOjcguLocpqWVonYOjH/pgbmtB790Gm99vf17+8Pbntd0KitXNLV3qTRgvBSab2XhgN3AncHfHA8ysCngG+IxzbmOfVykikk7MoGCEv7UNEgNoamhvPbfddq334Q2+O7utm7vtNmIURLVIxmB32jB2zsXN7EHgZfylTY8559aa2QOp/Y8A/wgUAz8wP/ow7pyr7r+yRUTSUG7+ydN7gr8O+sO6kwN68/t+qk9ov3a6cytao7kHFXMumN7i6upqt2zZskDeW0QkUM7BsQ9PDugDtXDkYPsxuXmnBnThSL82tGQsM3uvq8aqvlURkYFm5q9tHjYCxnXo5m5pggN7Tg7otW9BIu73h8JQVOa7tovKfDgXlvmWdViLZmQyhbGISLqI5cLo8f7WJpmAQ/vh4B5/PvrgHr/k5Kbl7ceEQj6QC1MBXTQyFdQj/WtK2lMYi4iks1DYt4RHjIJJ57dvb2mGQ/s63Or8/c4PIJlsPy6/oL0FXTjSX4ZVOFLnpNOMwlhEJBPFcmDkGH/rKJGAowd8MH/YIag3LfMB3iaa0x7O6vIOnMJYRCSbhMPtXdTjOmx3Do4fbW9BtwV15y7vttHdbUE9vENrOjdfrel+ojAWERkMzHyXdX4BVEw+eV/nLu/D+/156pqN7YPHwK9u1Rb0w0tTYV0Kw0s0yvsc6b+eiMhg112XdzIJxw51Cul9ULMBNixtP66tNd0W0CfCeiQMGarWdC8ojEVEpGuhUPtMY1XTTt7X0uRbz4f3+fu2sN696dTWdFvruaDEv9awYn8/ZJimB01RGIuIyJmL5fbcmu4c0rVb/MxjHSeaCkf8tdYnAjoV0sNSj2ODZ5pQhbGIiPSdjq3pMZ1a0/FWH9RHD/jZxtrujxzwC210HO0Nvov7pLDucJ9fmFWtaoWxiIgMjEg0dU659NR9zkFzow/mzmG9bydsWXlyqzoUgqFF7QHdNqNZW8s6w0Z+K4xFRCR4Zn4+7ty8U7u+wc9EduwwHKn3y1d2bFXXr/YrZnUUzYFhRe0h3TGo07ALXGEsIiLpLxRu7/7uSkszHD148u3IAR/ctVugtVMXeG5eh67vTrehhb4VP4AUxiIikvliOVA82t86cw6ajqdC+kAqqFOBXb8btq/xM5e1MYO8Ah/U1y7yXd79TGEsIiLZzQyG5Ptbl13gSTh+pEOLOnV/7MMBW2hDYSwiIoNbKOS7pocWwugJwZQQyLuKiIjICQpjERGRgCmMRUREAqYwFhERCZjCWEREJGAKYxERkYApjEVERAKmMBYREQmYwlhERCRgCmMREZGAKYxFREQCpjAWEREJmMJYREQkYOacC+aNzfYDO/rwJUuA+j58vXSU7Z8x2z8fZP9n1OfLfNn+GYP+fGOdc6WdNwYWxn3NzJY556qDrqM/ZftnzPbPB9n/GfX5Ml+2f8Z0/XzqphYREQmYwlhERCRg2RTGPwy6gAGQ7Z8x2z8fZP9n1OfLfNn+GdPy82XNOWMREZFMlU0tYxERkYyUcWFsZteZ2QYz22xmX+tiv5nZw6n9q8xsXhB1ni0zG2Nmr5nZOjNba2Zf7uKYhWZ22MxWpG7/GEStZ8vMtpvZ6lTty7rYn7HfoZlN7fC9rDCzI2b2l52Oybjvz8weM7N9Zramw7YRZvY7M9uUui/q5rk9/s2mg24+33fMbH3qd/BZMyvs5rk9/j6ni24+49fNbHeH38Ubunlupn6HP+/w2bab2Ypunhv8d+icy5gbEAa2ABOAGLASmN7pmBuA3wAGXAS8E3TdZ/gZRwPzUj8PAzZ28RkXAr8OutZz+IzbgZIe9mf0d9jhc4SBvfjrCjP6+wOuAOYBazps+xfga6mfvwb8927+G/T4N5sOt24+37VAJPXzf+/q86X29fj7nC63bj7j14G/Ps3zMvY77LT/fwD/mK7fYaa1jOcDm51zW51zLcATwM2djrkZ+C/nLQEKzWz0QBd6tpxze5xzy1M/HwXWARXBVjXgMvo77OBqYItzri8ntwmEc24xcLDT5puB/5P6+f8At3Tx1N78zQauq8/nnPutcy6eergEqBzwwvpQN99hb2Tsd9jGzAz4JPCzAS3qDGRaGFcAuzo8ruHUoOrNMRnBzMYB5wPvdLH7YjNbaWa/MbMZA1vZOXPAb83sPTO7v4v92fId3kn3f/yZ/P21KXPO7QH/P5HAyC6OyZbv8nP43pqunO73Od09mOqKf6ybUw3Z8B1eDtQ55zZ1sz/w7zDTwti62NZ5OHhvjkl7ZjYU+AXwl865I512L8d3fc4B/jfw3ACXd64udc7NA64H/sLMrui0P+O/QzOLATcBT3WxO9O/vzORDd/lfwPiwOPdHHK63+d09u/ARGAusAffldtZxn+HwF303CoO/DvMtDCuAcZ0eFwJ1J7FMWnNzKL4IH7cOfdM5/3OuSPOuWOpn18EomZWMsBlnjXnXG3qfh/wLL4brKOM/w7xf9TLnXN1nXdk+vfXQV3b6YPU/b4ujsno79LM7gNuBO5xqZOLnfXi9zltOefqnHMJ51wS+A+6rj3Tv8MIcBvw8+6OSYfvMNPCeCkw2czGp1oedwLPdzrmeeDe1Ijci4DDbV1pmSB1buM/gXXOuf/ZzTGjUsdhZvPx3+OBgavy7JlZvpkNa/sZP0hmTafDMvo7TOn2/8Qz+fvr5HngvtTP9wG/7OKY3vzNpiUzuw54CLjJOXe8m2N68/uctjqNxbiVrmvP2O8w5RpgvXOupqudafMdBjl67Gxu+JG2G/Gj+/5batsDwAOpnw34fmr/aqA66JrP8PNdhu8CWgWsSN1u6PQZHwTW4kc1LgEuCbruM/h8E1J1r0x9hmz8DvPw4Tq8w7aM/v7w/2OxB2jFt5T+FCgGXgU2pe5HpI4tB17s8NxT/mbT7dbN59uMP1fa9nf4SOfP193vczreuvmMP0n9ja3CB+zobPoOU9t/3Pa31+HYtPsONQOXiIhIwDKtm1pERCTrKIxFREQCpjAWEREJmMJYREQkYApjERGRgCmMRUREAqYwFhERCZjCWEREJGD/P7R5o0S6ber+AAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 576x432 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Train loss\n",
    "y_loss = history.history['loss']\n",
    "# validation loss\n",
    "y_vloss = history.history['val_loss']\n",
    "\n",
    "plt.figure(figsize=(8,6))\n",
    "x_len = np.arange(len(y_loss))\n",
    "plt.plot(x_len, y_loss,  label='Train Loss', c='coral', alpha=.8)\n",
    "plt.plot(x_len, y_vloss,  label='Validation Loss', c='cornflowerblue', alpha=.8)\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "69340dae",
   "metadata": {},
   "outputs": [],
   "source": [
    "pred = best_model.predict(padded_test)\n",
    "pred = tf.argmax(pred, axis = 1)\n",
    "\n",
    "df = pd.read_csv('open/open/sample_submission.csv')\n",
    "df['label'] = pred\n",
    "df.to_csv('open/open/Baseline_test1.csv', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "fd220921",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>label</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>174304</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>174305</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>174306</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>174307</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>174308</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43571</th>\n",
       "      <td>217875</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43572</th>\n",
       "      <td>217876</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43573</th>\n",
       "      <td>217877</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43574</th>\n",
       "      <td>217878</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43575</th>\n",
       "      <td>217879</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>43576 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        index  label\n",
       "0      174304      0\n",
       "1      174305      0\n",
       "2      174306      0\n",
       "3      174307      0\n",
       "4      174308      0\n",
       "...       ...    ...\n",
       "43571  217875     19\n",
       "43572  217876      0\n",
       "43573  217877      2\n",
       "43574  217878      0\n",
       "43575  217879      0\n",
       "\n",
       "[43576 rows x 2 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.read_csv('open/open/Baseline_test1.csv')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
